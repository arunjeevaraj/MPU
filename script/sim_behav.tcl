# ####################################################################### #
# MODELSIM BEHAVIORAL SIMULATION SCRIPT
# ####################################################################### #
# ----------------------------------------------------------------------- #
# Set paths
# ----------------------------------------------------------------------- #
set dir_path "."
set script_path "$dir_path/script"

# ----------------------------------------------------------------------- #
# Design setup
# ----------------------------------------------------------------------- #
source $script_path/design_setup.tcl

# ----------------------------------------------------------------------- #
# Project
# ----------------------------------------------------------------------- #
quit -sim

# ----------------------------------------------------------------------- #
# Compile
# ----------------------------------------------------------------------- #
source $script_path/com_top.tcl
source $script_path/com_tb.tcl

# ----------------------------------------------------------------------- #
# Simulate
# ----------------------------------------------------------------------- #
vsim -coverage -voptargs=+acc work.$tb_name

echo "----- Simulation started -----"
do $tb_path/wave_top_behav.do
onbreak {resume}
run -all
echo "----- Simulation done -----"

# ----------------------------------------------------------------------- #
# Coverage report
# ----------------------------------------------------------------------- #
coverage report -html -htmldir $report_path/covhtmlreport -threshL 50 -threshH 90
echo "----- Coverage report saved -----"
